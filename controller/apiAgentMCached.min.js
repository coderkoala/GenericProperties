"use strict";let view=require("./src/agentViewHelper");const cacheClass=require("persistent-cache");require("dotenv").config();class leadController{fetchLeadsRelatedAgentsFromCache(e,a){let t=cacheClass({base:"logs",name:"cacheDB",duration:36e5}),s=void 0===e.query.id||null===e.query.id||e.query.id.match(/(^\s+$|^$)|((@|\||\*|\^|\_|%|!|~|\+)+)/i)?"^invalid":`${e.query.id}`;if("^invalid"===s){return void a.status(400).json({title:"Invalid Lead",message:"Validation failed for the lead UUID.",icon:"error"})}let i=null;if(i=t.getSync(`${s}-raw`),i=!(!i||void 0===i.rawData)&&i.rawData,i){const e=new view(i);let t=e.outputAgentsCollection();a.status(200).json({title:"Success",message:"Computed Agents data has been fetched.",icon:"success",data:t})}else{a.status(400).json({title:"Session has expired",message:"Computed data no longer available, please refresh the window and try again.",icon:"error"})}}}module.exports=new leadController;